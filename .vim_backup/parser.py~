#!/home/bkapps/install/activepython/bin/python

from HTMLParser import HTMLParser
from htmlentitydefs import name2codepoint
import urllib
import re
from pyquery import PyQuery

TR = False;
class MyHTMLParser(HTMLParser):
    def handle_starttag(self, tag, attrs):
        global TR
        if(tag == 'table'):
            for name, value in attrs:
                if(name == 'class' and value == 'rst-data'):
                    TR = True
    def handle_endtag(self, tag):
        global TR
        if(tag == 'table'):
            TR = False
    def handle_data(self, data):
        global TR
        if(TR == True):
            print "data: ", data;
parser = MyHTMLParser()
url = "http://tabelog.com/tokyo/A1303/A130301/13090209/peripheral_map/";
html = urllib.urlopen(url).read();
html.strip();
html.strip("\n");

doc = PyQuery(html);
for td in doc("table.rst-data").find("tr.rst-name").find("td").find("p").find("strong"):
    print td.text;
