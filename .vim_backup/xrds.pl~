#!/usr/bin/perl

use strict;
use warnings;

use Mixi::OpenID::Util qw/ get_mixi_domain_ssl /;

my $domain = &get_mixi_domain_ssl;

my $body = << "__EOD__";
<?xml version="1.0" encoding="UTF-8"?>
<xrds:XRDS xmlns:xrds="xri://\$xrds" xmlns:openid="http://openid.net/xmlns/1.0" xmlns="xri://\$xrd*(\$v*2.0)">
  <XRD>
    <Service priority="0">
      <Type>http://specs.openid.net/auth/2.0/server</Type>
      <Type>http://openid.net/sreg/1.0</Type>
      <Type>http://openid.net/extensions/sreg/1.1</Type>
      <Type>http://openid.net/srv/ax/1.0</Type>
      <URI>${domain}/openid_server.pl</URI>
    </Service>
    <Service>
      <Type>http://specs.openid.net/auth/2.0/return_to</Type>
      <URI>${domain}/openid_consumer.pl</URI>
      <URI>${domain}/openid_consumer_docomo_spmode.pl</URI>
    </Service>
    <Service>
      <Type>http://specs.openid.net/extensions/ui/icon</Type>
      <URI>${domain}/img/basic/favicon.ico</URI>
    </Service>
  </XRD>
</xrds:XRDS>
__EOD__

print "Content-Type: application/xrds+xml\n";
print "Content-Length: " . (length $body) . "\n";
print "\n";
print $body;

